name: build-images-action

on:
  pull_request
  # push:
  #   branches:
  #   - 'main'
  #   - 'release-*'
  #   tags:
  #   - 'v*'

jobs:
  build_bmo:
    name: Build BMO container image
    # uses: metal3-io/project-infra/.github/workflows/container-image-build.yml@main
    uses: Nordix/metal3-project-infra/.github/workflows/container-image-build.yml@mquhuy/add-container-image-build-wf-template
    with:
      image-name: "baremetal-operator"
      pushImage: true
    secrets:
      QUAY_USERNAME: ${{ secrets.QUAY_USERNAME }}
      QUAY_PASSWORD: ${{ secrets.QUAY_PASSWORD }}
      SLACK_WEBHOOK: ${{ secrets.SLACK_WEBHOOK }}
  build_keepalived:
    name: Build keepalived container image
    # uses: metal3-io/project-infra/.github/workflows/container-image-build.yml@main
    uses: Nordix/metal3-project-infra/.github/workflows/container-image-build.yml@mquhuy/add-container-image-build-wf-template
    with:
      image-name: "keepalived"
      dockerfile-directory: resources/keepalived-docker
    secrets:
      QUAY_USERNAME: ${{ secrets.QUAY_USERNAME }}
      QUAY_PASSWORD: ${{ secrets.QUAY_PASSWORD }}
      SLACK_WEBHOOK: ${{ secrets.SLACK_WEBHOOK }}
